<?xml version="1.0"?>
<odoo>
    <record id="view_form_week_record" model="ir.ui.view">
        <field name="name">Week record Form</field>
        <field name="model">week.record</field>
        <field name="arch" type="xml">
            <form string="工作周报">
                    <group>
                        <div class="oe_title">
                            <h1><field name="name" readonly="1"/></h1>
                        </div>
                        <field name="week_num" invisible="1"/>
                        <field name="department_id" invisible="1"/>
                </group>
                <div>
                    <separator string="工作计划汇总"/>
                    <field name="week_mx_ok_ids">
                        <tree editable="top">
                            <field name="priority" string="优先级" />
                            <field name="name" string="事项" />
                            <field name="person_ids" widget="many2many_tags" options="{'no_create_edit': True}"/>
                            <field name="date_start" string="开始时间" />
                            <field name="date_end" string="预计结束时间" />
                            <field name="type"/>
                            <field name="probability" />
                            <field name="note" />
                            <field name="new_note" />
                            <button name="done" icon="fa-plus-square" string="本周举措" type="object" />
                            <button name="done_history" icon="fa-bars" string="历史情况" type="object"/>
                        </tree>
                    </field>
                    <separator string="本周新增计划"/>
                    <field name="week_record_mx_ids">
                        <tree editable="top">
                            <field name="priority" string="优先级" />
                            <field name="name" string="事项" />
                            <field name="person_ids" widget="many2many_tags" options="{'no_create_edit': True}"/>
                            <field name="date_start" string="开始时间" />
                            <field name="date_end" string="预计结束时间" />
                            <field name="new_note" />
                        </tree>
                    </field>
                </div>
            </form>
        </field>
    </record>

    <record id="view_tree_week_record" model="ir.ui.view">
        <field name="name">周报列表</field>
        <field name="model">week.record</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name" />
                <field name="week_num" />
                <field name="department_id" />
            </tree>
        </field>
    </record>

    <record id="view_search_week_record" model="ir.ui.view">
        <field name="name">周报过滤</field>
        <field name="model">week.record</field>
        <field name="arch" type="xml">
            <search string="Search">
                    <field name="name"/>
                    <field name="week_num"/>
                    <group expand='0' string='Group by...'>
                        <filter string='部门' name="departmentgroup" context="{'group_by': 'department_id'}"/>
                    </group>
               </search>
        </field>
    </record>

    <record id="view_tree_week_record_mx" model="ir.ui.view">
        <field name="name">事项列表</field>
        <field name="model">week.record.mx</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name" />
                <field name="create_date" string="创建时间"/>
            </tree>
        </field>
    </record>

        <record id="view_tree_week_record_mx_group" model="ir.ui.view">
        <field name="name">工作计划管理</field>
        <field name="model">week.record.mx</field>
        <field name="arch" type="xml">
            <tree>
                <field name="priority" string="优先级" />
                <field name="name" string="事项" />
                <field name="person_ids" widget="many2many_tags"/>
                <field name="date_start" string="开始时间" />
                <field name="date_end" string="预计结束时间" />
                <field name="probability" />
                <field name="note" />
                <field name="new_note" />
            </tree>
        </field>
    </record>

    <record id="action_week_record_mx_group" model="ir.actions.act_window">
        <field name="name">工作计划管理</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">week.record.mx</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="view_tree_week_record_mx_group" />
        <field name="domain">[('type','=','0')]</field>
        <field name="context">{'group_by':'department_id'}</field>
    </record>
</odoo>